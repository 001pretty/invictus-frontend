{"version":3,"sources":["components/checkout/MainCheckout.js","pages/Checkout.js"],"names":["MainCheckout","useForm","register","handleSubmit","errors","useState","errorMessage","setErrorMessage","cartItems","setCartItems","totalPrice","setTotalPrice","useContext","AuthContext","token","userId","userIdValue","tokenValue","history","useHistory","inputRef","useRef","useEffect","current","focus","axios","post","headers","Authorization","then","res","total","data","foundCartItems","forEach","item","parseFloat","price","slice","q","_id","toFixed","catch","err","console","log","onSubmit","event","preventDefault","products","user","information","firstname","lastname","address","postalcode","city","push","className","style","color","type","placeholder","name","alt","ref","e","required","minLength","maxLength","target","to","Checkout"],"mappings":"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","file":"static/js/7.b1d67504.chunk.js","sourcesContent":["import React, { useState, useEffect, useContext, useRef } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\n\r\nimport \"./MainCheckout.css\";\r\n\r\nimport { AuthContext } from \"context/AuthContext\";\r\n\r\nfunction MainCheckout() {\r\n  const { register, handleSubmit, errors } = useForm();\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const [cartItems, setCartItems] = useState([]);\r\n  const [totalPrice, setTotalPrice] = useState();\r\n  const { token, userId } = useContext(AuthContext);\r\n  const [userIdValue,] = userId;\r\n  const [tokenValue,] = token;\r\n\r\n  const history = useHistory();\r\n  \r\n  const inputRef = useRef();\r\n  useEffect(() => {\r\n    inputRef.current.focus()\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .post(\r\n        \"/items/cartitems\",\r\n        { userId: userIdValue },\r\n        {\r\n          headers: {\r\n            Authorization: \"Bearer \" + tokenValue,\r\n          },\r\n        }\r\n      )\r\n      .then((res) => {\r\n        let total = 0;\r\n        res.data.foundCartItems.forEach((item) => {\r\n          total =\r\n            total + parseFloat(item.price.slice(0, -1)) * item.q[item._id];\r\n        });\r\n        setTotalPrice(total.toFixed(2));\r\n        setCartItems(res.data.foundCartItems);\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      }); \r\n  }, [tokenValue, userIdValue]);\r\n\r\n  const onSubmit = (data, event) => {\r\n    event.preventDefault();\r\n\r\n    axios\r\n      .post( \r\n        \"/items/order\",\r\n        {\r\n          products: {\r\n            products: cartItems,\r\n            totalPrice: totalPrice,\r\n          },\r\n          user: {\r\n            information: {\r\n              firstname: data.firstname,\r\n              lastname: data.lastname,\r\n              address: data.address,\r\n              postalcode: data.postalcode,\r\n              city: data.city,\r\n            },\r\n            userId: userIdValue,\r\n          },\r\n        },\r\n        {\r\n          headers: {\r\n            Authorization: \"Bearer \" + tokenValue,\r\n          },\r\n        }\r\n      )\r\n      .then((res) => {\r\n        history.push(\"/profile\");\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n        setErrorMessage(\"Invalid input.\");\r\n      });\r\n  };\r\n\r\n  return (\r\n          <form onSubmit={handleSubmit(onSubmit)}>\r\n    <div className=\"CheckoutContainer\">\r\n      <div className=\"CheckoutFormWrapper\">\r\n        <div className=\"CheckoutForm\">\r\n            {errors.firstname && (\r\n              <p className=\"CheckoutText\" style={{ color: \"red\" }}>\r\n                Firstname is invalid\r\n              </p>\r\n            )}\r\n            {errors.lastname && (\r\n              <p className=\"CheckoutText\" style={{ color: \"red\" }}>\r\n                Lastname is invalid\r\n              </p>\r\n            )}\r\n            {errors.address && (\r\n              <p className=\"CheckoutText\" style={{ color: \"red\" }}>\r\n                Address is invalid\r\n              </p>\r\n            )}\r\n            {errors.postalcode && (\r\n              <p className=\"CheckoutText\" style={{ color: \"red\" }}>\r\n                Postal code is invalid\r\n              </p>\r\n            )}\r\n            {errors.city && (\r\n              <p className=\"CheckoutText\" style={{ color: \"red\" }}>\r\n                City is invalid\r\n              </p>\r\n            )}\r\n            <p className=\"LoginText\" style={{ color: \"red\" }}>\r\n              {errorMessage}\r\n            </p>\r\n            <div className=\"CheckoutHeading\">Invictus Store</div>\r\n            <p className=\"CheckoutText\">Shipping address:</p>\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"First name\"\r\n              name=\"firstname\"\r\n              alt=\"firstname\"\r\n              ref={(e) => {\r\n                  register(e, { required: true, minLength: 2, maxLength: 35 })\r\n                  inputRef.current = e\r\n                }\r\n              }\r\n            />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Last name\"\r\n              name=\"lastname\"\r\n              alt=\"lastname\"\r\n              ref={register({ required: true, minLength: 2, maxLength: 35 })}\r\n            />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Address\"\r\n              name=\"address\"\r\n              alt=\"address\"\r\n              ref={register({ required: true, minLength: 5, maxLength: 35 })}\r\n            />\r\n            <input\r\n              type=\"number\"\r\n              placeholder=\"Postal code\"\r\n              name=\"postalcode\"\r\n              alt=\"postalcode\"\r\n              ref={register({ required: true, minLength: 5, maxLength: 5 })}\r\n            />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"City\"\r\n              name=\"city\"\r\n              alt=\"city\"\r\n              ref={register({ required: true, minLength: 2, maxLength: 35 })}\r\n            />\r\n            <button type=\"submit\" className=\"btn effect01\" target=\"_blank\">\r\n              <span>ORDER NOW</span>\r\n            </button>\r\n          <br />\r\n          <div className=\"CheckoutText\">\r\n            Want to make some changes?{\" \"}\r\n            <Link to=\"/cart\" style={{ color: \"inherit\" }}>\r\n              Return to cart\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n          </form>\r\n  );\r\n}\r\n\r\nexport default MainCheckout;\r\n","import React from \"react\";\r\n\r\nimport MainCheckout from \"components/checkout/MainCheckout\";\r\n\r\nfunction Checkout() {\r\n  return (\r\n    <div>\r\n      <MainCheckout />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Checkout;\r\n"],"sourceRoot":""}